第四章Illumina测序数据分析方法简介
第四章Illumina测序数据分析方法简介
第一节 下机数据的初步处理

一、CASAVA的运行和参数设置

在Illumina数据下机后的输出文件中，并不直接存在后续分析所需要的Fastq文件，需要通过bcl2fastq Conversion Software（v1.8.4; http://support.illumina.com/ downloads/bcl2fastq_con version _software_184.html）（该软件原名为CASAVA，后更名为bcl2fastq）来实现。

（一）样品清单

以处理Hiseq2500测序仪下机数据为例，在运行bcl2fastq时，需要提供所有样本名称与对应Index表格，称为样品清单（sample sheet），具体格式如图4.1所展示；其中FCID为flow cell的编号；Lane列为样本所在Lane编号；Sample ID列为样本名称；Index列为样本对应的Index序列，同一条Lane的样本不能使用相同Index；如果在同一条Lane中混合不同的测序样本，建议尽量使每个样本的Index与其他样本之间至少有2个碱基的差异；如果在HiSeq2500测序中引入了双Index标记，在样品清单中可以使用“-”连接两组Index；Sample Project列为样本所属的研究项目名称（project）。

![图4.图4. \* ARABIC1Hiseq 2500样品清单](http://static.online.sciencereading.cn/readerpublic/afc7ae5a-9dfb-4133-3e5a-169e2f0e8cb2_d3b8ac6f6843e1d930ad6316733afcae/OPS/Images/Picture66_normal.png)

图4.图4. \* ARABIC1Hiseq 2500样品清单

（二）bcl2fastq

bcl2fastq根据样品清单表格中Sample Project构建一级目录，同一Project下所有样品放在下一级目录。根据同一Project下样本的Index不同，R1和R2端fastq文件分别输出为压缩格式，放在/Sample Project/Sample ID/目录下。如果Index无法匹配则输出到/Undetermined_ indice /Sample_lane/录下。

以处理Hiseq2500测序仪下机数据为例，bcl2fastq该命令的使用如下，包括两步命令运行：

perl/bcl2fastq-1.8.3/bin/configureBclToFastq.pl--input-dir $inputdir--output-dir

$outputdir--sample-sheet $samplecsv--force--ignore-missing- bcl--use-bases-mask

y257n，I6n，Y257n --mismatches 1

make –j 10

参数中$input指向下机数据目录；$ outputdir为输出目录；$samplecsv指向samplesheet；--mismatch 1参数为允许样本Index有一个错配。

（三）其他测序仪的文件转换

2015年下半年，Illumina公司新推出了Hiseq3000/4000及Next500系列测序仪，由于测序原理上的改进，bcl2fastq Conversion Software2（v2.17）整体版本也进行了相应升级；样品清单表格格式改为与Miseq系列的表格相似，具体情况和命令变化见图4.2。

![图4.图4. \* ARABIC2Hiseq 3000/4000样品清单](http://static.online.sciencereading.cn/readerpublic/afc7ae5a-9dfb-4133-3e5a-169e2f0e8cb2_d3b8ac6f6843e1d930ad6316733afcae/OPS/Images/Picture67_normal.png)

图4.图4. \* ARABIC2Hiseq 3000/4000样品清单

相应的运行命令更改为：

/bcl2fastq2-2.17/bin/bcl2fastq -i $inputdir --output-dir $outputdir --sample-sheet $samplecsv

--ignore-missing-bcl --use-bases-mask y150n，I6n，Y150n --ignore-missing-filter

--ignore-missing-controls --ignore-missing-positions

（四）文件转化前后的目录结构

图4.3中所展示的为下机数据原始目录结构和通过bcl2FASTQ处理后的文件目录。

![图4.图4. \* ARABIC3原始数据和处理后数据结构对比](http://static.online.sciencereading.cn/readerpublic/afc7ae5a-9dfb-4133-3e5a-169e2f0e8cb2_d3b8ac6f6843e1d930ad6316733afcae/OPS/Images/Picture68_normal.png)

图4.图4. \* ARABIC3原始数据和处理后数据结构对比

（五）查看下机数据产量和质量

（1）通过bcl2fastq生成的文件查看

在完成bcl2fastq后可以通过生成目录下文件/Basecall_Stats_[FCID]/Demultiplex_ Stats.htm文件查看本次数据的整体产量和质量，如下表。

![1](http://static.online.sciencereading.cn/readerpublic/afc7ae5a-9dfb-4133-3e5a-169e2f0e8cb2_d3b8ac6f6843e1d930ad6316733afcae/OPS/Images/Picture69_normal.png)

（2）通过SAV查看器查看

在运行bcl2fastq之前，同样可以获得本次数据的产量与质量，通过Illumina Sequencing Analysis Viewer（SAV，http://support.illumina.com/sequencing/sequencing_software/sequencing _analysis_viewer_sav.html）获得；通过SAV查看器打开含有InterOp、RunInfo.xml、runParame ters.xml 3个文件的文件夹（这3个文件位于原始下机目录中），如图4.4、图4.5所示。

![图4.4 SAV文件展示1](http://static.online.sciencereading.cn/readerpublic/afc7ae5a-9dfb-4133-3e5a-169e2f0e8cb2_d3b8ac6f6843e1d930ad6316733afcae/OPS/Images/Picture70_normal.png)

图4.4 SAV文件展示1

![图4.5 SAV文件展示2](http://static.online.sciencereading.cn/readerpublic/afc7ae5a-9dfb-4133-3e5a-169e2f0e8cb2_d3b8ac6f6843e1d930ad6316733afcae/OPS/Images/Picture71_normal.png)

图4.5 SAV文件展示2

二、下机数据的质控处理

（一）Fastq文件格式

由于实验操作和测序仪器等原因，会导致测序数据中部分短序列（reads）尾部质量下降或接头（adapter）自连，这些序列会对后期的数据分析造成困扰，所以在拿到原始的Fastq文件后我们需要对数据进行质量控制，去掉一些低质量的序列。

首先我们需要了解下机数据的Fastq文件格式；Fastq文件为4行一组的序列格式。

@SEQ_ID

GATTTGGGGTTCAAAGCAGTATCGATCAAATAGTAAATCCATTTGTTCAACTCACAGTTT

+

!''*（（（（***+））%%%++）（%%%%）.1***-+*''））**55CCF>>>>>>CCCCCCC65

@列为序列名字，其中包含一个绝对名字、样本所在Lane、Cluster坐标位置和R1/R2端标志等信息。例如，@HWI-D00447:78:XXXXXXX:1:1101:1217:1986 1:N:0:ACAGTG；其中HWI-D00447:78: XXXXXXX为绝对名字；1表示位于Lane1；1101为芯片号；1217:1986为坐标位置；1:N:0: ACAGTG表示该条序列为R1端序列，N表示序列没有经过CASVA filter（如果设置过CASAVA过滤reads，这里显示Y）；ACAGT表示该条序列的Index。

第二行为具体序列信息。

第三行为“+”。

第四行为该条序列每个碱基的质量值（计算公式如下），表示为该碱基的错误率：将转换后的值通过ASCII转换为字符后显示；这种方式被称为Phred；现在HiSeq测序仪使用phred+64的计算方式，数据质量从0到40；分别对应!"#$%&'（）*+，-./0123456789:;<=>[email protected]；质量值为10时说明，该碱基的错误率为10%；20时表示错误率为1%；40时表示错误率为0.01%。

![1](http://static.online.sciencereading.cn/readerpublic/afc7ae5a-9dfb-4133-3e5a-169e2f0e8cb2_d3b8ac6f6843e1d930ad6316733afcae/OPS/Images/FieldEmbed6_normal.png)

（二）通过Trimmomatic进行原始数据质控

根据每条序列中带有的质量信息，我们可以通过一定的过滤条件去掉一些质量过低的序列和碱基；如使用Trimmomatic（Bolger et al.，2014）（http://www.usadellab.org/cms/?page=trimmomatic）、fastx（Gordon and Hannon，2010）（http:// hannonlab.cshl.edu/fastx_toolkit/）等软件实现。

Trimmomatic可以非常方便地实现一次运行多个参数的过滤条件，运行参数如下：

java -jar trimmomatic-0.30.jar PE -phred33 input_forward.fq.gz

input_reverse.fq.gz

output_forward_paired.fq.gz output_forward_unpaired.fq.gz

output_reverse_paired.fq.gz

output_reverse_unpaired.fq.gz

ILLUMINACLIP:TruSeq3-PE.fa:2:30:10 LEADING:3 TRAILING:3 SLIDINGWINDOW:4:15 MINLEN:36

命令中通过给定双端测序的原始fastq.gz文件input_forward.fq.gz和input_ reverse.fq.gz，指定输出文件为4个文件，分别为R1配对和未配对序列文件，R2端配对和未配对序列文件；同时设定接头（adapter）序列文件TruSeq3-PE.fa（软件自带，该文件为Illumina连接序列用的固定序列）；并制定了以下数据过滤原则：如序列头部和尾部质量值都低于3的碱基去掉，以4个碱基为窗口滑动，将平均质量低于15的窗口以后的碱基丢掉，最后设定保留最小长度为36 bp。

（三）Fastx

Fastx软件更加灵活，可以通过15个子程序分别实现序列的切割和转换，根据低质量比例去除reads；如去除质量值低于20的碱基占序列总长度50%的序列。

fastq_quality_filter -q 20 -p 50 –i R1.fastq -o R1_filter.fastq

（四）对比原始序列和过滤后序列情况

![图4.6 fastqc碱基质量展示](http://static.online.sciencereading.cn/readerpublic/afc7ae5a-9dfb-4133-3e5a-169e2f0e8cb2_d3b8ac6f6843e1d930ad6316733afcae/OPS/Images/Picture73_normal.png)

图4.6 fastqc碱基质量展示

图4.6为对比原始序列和过滤后序列情况，可以通过Fastqc（http://www.bioinformatics. babraham.ac.uk/projects/fastqc/）软件对比序列质量。图中横坐标表示碱基位置，纵坐标表示每个位置上碱基质量的情况，左图表示质控前，右图表示质控后。

（高 强）

第二节DNA测序数据分析简介

一、基因组从头测序数据分析

基因组从头（de novo）测序是指在没有参考基因组的情况下，对物种的基因组进行测序、拼接和组装，进而获得物种的基因组序列图谱。物种基因组序列图谱的完成，是进一步研究该物种的遗传信息与进化的基础。

2010年熊猫基因组（Li et al.，2010）的完成，标志着二代从头测序技术在国内的开始，采用全基因组鸟枪法（whole genome shotgun，WGS）与二代测序相结合的技术，构建了BAC文库和插入片段长度分别为500 bp、2 kb、5 kb、10 kb的二代测序文库，获得平均读长52 bp的序列，可用碱基约176 GB（测序深度约为73×），最终组装出了大熊猫的21条染色体，约2.4 Gb的基因组序列。contig N50长约40 kb，同时注释了2万多个基因。通过同源基因的分析发现大熊猫不喜欢吃肉的主要原因是T1R1基因失活，无法感觉到肉的鲜味。类似的，2013年发表的藏猪基因组同样也是利用二代测序技术完成了基因组从头测序。相对而言，某些植物和昆虫的基因组庞大、复杂度高、重复序列多，从头测序难度更大，但是时随着二代测序技术的提升，如序列读长的增加，测序时间的降低，一些基因组复杂的多倍体物种，如二倍体小麦A基因组（Ling et al.，2013）和D基因组草图（Jia et al.，2013）已经完成。伴随着读长更长的新一代测序技术的发展，相信未来会有越来越多的物种基因组得到解析，进而让我们更加深入地了解物种进化的历史。

（一）分析流程

基因组从头测序序列的组装是项复杂的工作，在计算过程中涉及大量的数据和计算资源消耗，在此我们仅列出一个基本的分析流程（图4.7）和简要的分析参数。在测序数据方面，不同复杂度的基因组数据测序深度需100X～200X。

（二）分析参数

要进行基因组从头（de novo）测序，研究者首先要对物种进行基因组调查（survey），了解基因组的大小和杂合度等情况。基因组大小可以通过查询相关数据库获得，如http://www.genomesize.com/；或者通过实验获得，如流式细胞仪（Yoshida et al.，2010）测定，福尔根染色，定量PCR和k-mer估计等。

![图4.7从头测序分析流程](http://static.online.sciencereading.cn/readerpublic/afc7ae5a-9dfb-4133-3e5a-169e2f0e8cb2_d3b8ac6f6843e1d930ad6316733afcae/OPS/Images/Picture74_normal.png)

图4.7从头测序分析流程

估算k-mer值不仅可以估算基因组大小，同时也能检测基因组的杂合度，杂合度越高的物种基因组组装难度越大。

做k-mer估计时常用软件有Jellyfish（Lynam et al.，2006）（http://www. cbcb. umd.edu/ software /jellyfish/）和KmerGenie（Chikhi and Medvedev，2013），通过分析获得k-mer的统计频数，如图4.8所示。

![图4. 8 k-mer估计](http://static.online.sciencereading.cn/readerpublic/afc7ae5a-9dfb-4133-3e5a-169e2f0e8cb2_d3b8ac6f6843e1d930ad6316733afcae/OPS/Images/Picture75_normal.png)

图4. 8 k-mer估计

图4.9为牡蛎基因组（Zhang et al.，2012）在17-mer中调查发现的情况。双峰的情况说明基因组杂合度很大，超过35.49%的17-mer测序深度超过255×，说明基因组序列中存在大量的重复序列。

![图4. 9基因组杂合度可以通过k-mer的峰值情况](http://static.online.sciencereading.cn/readerpublic/afc7ae5a-9dfb-4133-3e5a-169e2f0e8cb2_d3b8ac6f6843e1d930ad6316733afcae/OPS/Images/Picture76_normal.png)

图4. 9基因组杂合度可以通过k-mer的峰值情况

（三）SOAPdenovo

目前有很多基因组组装软件工具可供选择，如DNA序列组装常用的SOAPdenovo（Xie et al.，2014a）（http://soap.genomics.org.cn/soapdenovo.html）、MaSuRCA（Zimin et al.，2013）（http://www.gen ome .umd.edu /masurca.html）等软件。SOAPdenovo的优点是组装速度非常快，对于内存和磁盘空间消耗较小，但缺点是所得的组装序列较短。MaSuRCA是2013年发表的一种功能强大的软件工具，软件自身带有碱基质量等处理过程，得到的contig序列长，但是组装耗费时间长，组装过程对磁盘空间消耗也大。如果我们用上述两种软件分别对10 G水稻数据进行组装，SOAPdenovo在15～30 min内即可结束，得到的contig N50长度约400 bp；而MaSuRCA耗时约为24 h，contig N50约为4 kb。

SOAPdenovo组装运行命令：

SOAPdenovo all -p 8 -s config.file -K 31 -R -o Sample 1 > ./Sample.log 2> Sample.err

Config.file中包含参数意义如下：

avg_ins=280：表示平均插入片段

reverse_seq=0

asm_flags=1：组装步骤1表示contig；2表示scaffold

rank=1

q1=R1.fastq

q2=R2.fastq

我们一般通过N50/N90等指标来评价组装结果，具体可以通过abyss（Simpson et al.，2009b）带的一个abyss_fac.pl脚本进行，具体命令如下。

perl abyss_fac.pl Sample.ctg.fasta >> Sample.ctg.result

二、重测序数据分析流程

对于完成从头测序的物种，我们已经获得了基因组的完整序列信息，利用全基因组重测序技术对其个体或群体的基因组进行测序及差异分析，可获得SNP、InDel、SV、CNV等大量的遗传变异信息，进而可以对该物种的基因功能挖掘和群体进化进行深入分析。

随着2002年人类基因组测序工作的完成，人类基因组重测序已经成为人类遗传学和转化医学的重要研究手段。在2012年发表的自闭症（Jiang et al.，2013）研究中，通过对32个自闭症家系进行全基因组重测序（30X深度），对单碱基突变和拷贝数变化进行检测，在综合分析已经发现的9个自闭症相关基因的基础上，进一步发现了4个新的自闭症基因和8个候选自闭症风险基因。近两年随着测序成本的下降，重测序技术已经深入到人们的日常生活中，如对于胎儿的21三体综合征、自闭症等孕期筛查和通过marker对癌症进行早期筛查。

在科研领域，对重要的农作物进行重测序，对于发觉其基因功能也是至关重要的。2014年发表的水稻（Chen et al.，2014a）研究中，选取529份水稻材料进行全基因组重测序，对两个亚群水稻代谢性状进行全基因组关联分析（GWAS），鉴定出2947个与634个基因相关的主导SNP位点。随后，在210个籼稻的自交群体中进行验证，定位出36个候选基因与代谢相关。对36个候选基因进行实验验证，最终确定了5个候选基因。2015年发表的302份代表性大豆材料（Zhou et al.，2015）的全基因组重测序工作表明：大豆在驯化过程中受到了强烈的选择瓶颈效应，鉴定出121个强选择信号；同时对大豆的种子大小、种皮颜色、生长习性、油含量等性状做了全基因组关联分析，找出了一系列显著关联位点；把选择信号、GWAS信号及前人研究的油含量QTL相整合，发现很多选择信号和油相关性状有关，说明大豆产油性状受人工选择较多，形成了复杂的网络系统，共同调控油的代谢，从而引起不同种油质相关性状的变异。研究还定位了一些重要农艺性状的调控位点，并且明确了一些基因在区域化选择中的作用，如控制花周期的E1、控制生长习性的Dt1、控制绒毛颜色的T等。这为大豆重要农艺性状调控网络的研究奠定了重要基础。

除了利用全基因组鸟枪法（WGS）对基因组进行随机打断测序，获得全基因组的序列信息外，近年来还出现了成本更加低廉的重测序方法，如GBS、RAD等简化基因组方法，通过对特定酶酶切后的基因组DNA片段进行高通量测序，可以保证在更低数据量的情况下获得全基因组的SNP信息。例如，2013年发表的针对于高粱株高（Morris et al.，2013）的研究中，通过对971份高粱材料进行GBS高通量测序，产生了21 G的测序数据，获得265 487个SNP；对其中336株高粱个体进行全基因组关联分析，发现多个与株高相关的已知基因，并定位到多个与花序结构相关的候选基因。

（一）重测序分析流程

基因组重测序分析的一般流程如图4.10所示

![图4.10重测序分析流程](http://static.online.sciencereading.cn/readerpublic/afc7ae5a-9dfb-4133-3e5a-169e2f0e8cb2_d3b8ac6f6843e1d930ad6316733afcae/OPS/Images/Picture77_normal.png)

图4.10重测序分析流程

（二）mapping

群体分析的第一步是将测序得到的短序列比对（mapping）回基因组，常用的DNA比对软件有BWA（Li and Durbin，2009b）。

1）BWA比对之前需要对参考基因组构建索引（index）。

bwa inde reference.fasta表示对参考基因组构建索引。

bwa mem –t 8 ref.fa reads.fq > aln-se.sam表示单端（single end，SE）测序数据，通过8个核运行。

bwa mem –t 8 –M ref.fa read1.fq read2.fq > aln-pe.sam表示双端（pair end，PE）测序数据，通过8个核运行，对短序列进行处理。

2）文件格式转换和变异检测：比对生成的文件为sam文件，可以通过Samtools（Li et al.，2009）进行进一步处理和查看，其中包含了每条序列的比对位置、比对的具体情况；sam格式一般较大，通过转换一般存储为二进制压缩的bam格式；并且比对后的序列，根据比对位置进行排序后，可以进行可视化查看和变异检测。具体可以通过如下命令进行。

smatools view [email protected] 8 –bS aln-pe.sam >> aln-pe.bam表示sam压缩为bam；[email protected]为多核参数。

samtools sort [email protected] aln-pe.bam aln-pe.sorted.bam表示bam文件排序。

（三）重测序的数据质量评估

完成比对得到bam文件后，通过分析bam文件我们可以对重测序的数据质量进行评估，常见的评估指标包括：①比对短序列比例（mapping ratio），即比对上的短序列占总测序序列的比例；②深度（depth），即基因组上被覆盖的碱基平均被多少条短序列（reads）覆盖；③覆盖度（coverage），即基因组多少碱基被reads覆盖；④插入片段长度（insert size），即指建库时打断片段长度，通过R1和R2端序列比对在参考基因组上的间距，构建频数分布图，一般检测峰值长度和是否是单峰。

1）运行samtools flagstat aln-pe.sorted.bam命令，屏幕输出短序列比例，结果示例如下。

![](http://static.online.sciencereading.cn/readerpublic/afc7ae5a-9dfb-4133-3e5a-169e2f0e8cb2_d3b8ac6f6843e1d930ad6316733afcae/OPS/Images/Picture78_normal.png)

2）运行soap.coverage -cvg -sam -p 5 -i pe.sam -refsingle ref.fasta –o pe.coveage命令，屏幕输出覆盖度和测序深度，结果示例如下。

![](http://static.online.sciencereading.cn/readerpublic/afc7ae5a-9dfb-4133-3e5a-169e2f0e8cb2_d3b8ac6f6843e1d930ad6316733afcae/OPS/Images/Picture79_normal.png)

3）运行java-jar picard/CollectInsertSizeMetrics.jar INPUT=aln-pe.sort.bam DEVIATIONS=10 HISTOGRAM_FILE= pe.hist.DV10.pdf OUTPUT= pe.DV10.txt命令，输出文库不同插入片段长度频数分布图，示例结果如图4.11所示。

![图4.11插入片段长度频数分布图](http://static.online.sciencereading.cn/readerpublic/afc7ae5a-9dfb-4133-3e5a-169e2f0e8cb2_d3b8ac6f6843e1d930ad6316733afcae/OPS/Images/Picture80_normal.png)

图4.11插入片段长度频数分布图

同时，我们也可以通过IGV等可视化软件，查看短序列在参考基因组的比对情况。

（四）变异检测

对于变异检测常见的是寻找个体间的单核苷酸多态性（SNP）和一些短的插入缺失突变（InDel）；常用的软件包括GATK（McKenna et al.，2010a）、Samtools（Li et al.，2009）和SOAPsnp（Li et al.，2008）。

1. GATK

（1）GATK分析流程

基因组分析工具包GATK（genome analysis toolkit，http://www. broadinstitute. org/gatk/）是由BROAD中心开发的一套专门针对高通量测序数据进行变异检测的工具，该软件在人和动物群体中应用相当广泛，该软件提供了详细的操作规范和使用流程信息（https://www.broadinstitute.org/gatk/guide/best-practices?bpm=DNAseq# data-processing -ovw），具体分析流程如图4.12所示。

（2）GATK运行命令

GATK软件推荐使用Bwa mem进行短序列比对，通过Picard（http://broadinstitute.github.io/picard/）进行重复序列的标记，然后根据流程调用GATK工具的不同方法进行操作，具体流程可参考以下脚本。

![图4.12 GATK推荐分析流程](http://static.online.sciencereading.cn/readerpublic/afc7ae5a-9dfb-4133-3e5a-169e2f0e8cb2_d3b8ac6f6843e1d930ad6316733afcae/OPS/Images/Picture81_normal.png)

图4.12 GATK推荐分析流程

1）#输入排序后的Bam文件。

java -Djava.io.tmpdir=./tmp -jar picard/MarkDuplicates.jar I=PE.sorted.bam

O=/PE.marked.bam METRICS_FILE=/PE.metricsFile CREATE_INDEX=true

VALIDATION_STRINGENCY=LENIENT REMOVE_DUPLICATES=true

ASSUME_SORTED=true

java -Djava.io.tmpdir=./tmp -jar GenomeAnalysisTK.jar -nt 4 -T RealignerTargetCreator

-R reference.fasta -o ./PE.intervals.list -I ./PE.marked.bam

java -Djava.io.tmpdir=./tmp -jar GenomeAnalysisTK.jar -T IndelRealigner –R

reference.fasta -I ./PE.marked.bam --targetIntervals ./PE.intervals.list -o ./PE.realigned.bam

java -Xmx20g -Djava.io.tmpdir=./tmp -jar GenomeAnalysisTK.jar -nct 4 –T

BaseRecalibrator -l INFO -R reference.fasta -I ./PE.realigned.bam –cov

ReadGroupCovariate -cov QualityScoreCovariate -cov CycleCovariate -o ./PE.b.recalFile

--run_without_dbsnp_potentially_ruining_quality

2）#单个个体的变异检测。

java -Djava.io.tmpdir=./tmp -jar GenomeAnalysisTK.jar -nct 4 -T PrintReads –R

reference.fasta -I ./PE.realigned.bam -o ./PE.recalibrated.bam -BQSR ./PE.b. recalFile

java -Xmx15g -Djava.io.tmpdir=./tmp -jar GenomeAnalysisTK.jar -T HaplotypeCaller –R

reference.fasta -I PE.recalibrated.bam -o ./raw.vcf --genotyping_mode DISCOVERY

3）对于单个个体的变异检测可以根据一步直接获得；而对于群体数据需要先分别对个体样本进行以上脚本。

a）#对Sample1获得GVCF文件。

java -Djava.io.tmpdir=./tmp0 -jar GenomeAnalysisTK.jar -T HaplotypeCaller -R reference.fasta -I Sample1.recalibrated.bam -o ./Sample1.gvcf --genotyping_mode DISCOVERY --emitRefConfidence GVCF

b）#对Sample2获得GVCF文件。

java -Djava.io.tmpdir=./tmp0 -jar GenomeAnalysisTK.jar -T HaplotypeCaller -R reference.fasta -I Sample2.recalibrated.bam -o ./Sample2.gvcf --genotyping_mode DISCOVERY --emitRefConfidence GVCF

c）#合并GVCF文件得到群体变异数据。

java -Djava.io.tmpdir=./tmp -jar GenomeAnalysisTK.jar -T GenotypeGVCFs -R reference.fasta -V Sample1.gvcf -V Sample2.gvcf -o ./combine.vcf -nt 8

对于目前通用的变异文件输出文件，大部分软件都兼容VCF格式，目前已经更新到4.2版本（http://samtools.github.io/hts-specs/VCFv4.2.pdf）；具体格式如下。

![](http://static.online.sciencereading.cn/readerpublic/afc7ae5a-9dfb-4133-3e5a-169e2f0e8cb2_d3b8ac6f6843e1d930ad6316733afcae/OPS/Images/Picture82_normal.png)

VCF文件主要包括头部“#”开始的注释文件信息，包括格式版本号、使用的参考基因组地址和参考基因组染色体长度等；从“#Chrom”开始，为VCF文件正文，文件前9列为固定格式，分别为如下信息：检测到变异的染色体、位置、ID、参考基因组碱基信息、观察到个体的碱基信息、质量值、过滤标签、信息列（包括总深度，观察到的样本等该位点的具体信息）和样本标签格式；从第十列开始为每个样本的具体情况。

2. Samtools

Samtools同样也能快速地检测变异，并且使用方便，同时生成兼容的VCF格式。基本操作如下。

#通过Samtools调用mpileup的方法，对Sample1和Sample2进行群体变异检测，同时通过bcftools转换为vcf格式

samtools1.2 mpileup -t DP，DP4 -ugf reference.fasta Sample1.sorted.bam Sample2.sorted.bam |bcftools1.2 call -vmO z -o samtools.vcf.gz

群体测序的关联分析过程

三、群体分析流程

在群体分析中，通过高通量测序获得群体基因组变异数据后，我们可以与表型数据结合进行基因定位工作，也可以通过野生品种与现有品种比较进行驯化与进化分析。在获得群体变异数据后一般可以进行以下分析（图4.12）。

![图4.12群体分析流程](http://static.online.sciencereading.cn/readerpublic/afc7ae5a-9dfb-4133-3e5a-169e2f0e8cb2_d3b8ac6f6843e1d930ad6316733afcae/OPS/Images/Picture83_normal.png)

图4.12群体分析流程

（二）SNP注释

在获得群体基因组变异情况后，可以通过ANOVA、SNPEFF等软件对VCF文件进行注释，分析变异是否发生在基因区域，深入分析是同义突变还是非同义突变。在植物研究中，通过辐射手段进行诱变育种，可以快速获得不同性状个体。例如，对水稻种质资源Oryza sativaL. ssp.indica（9311）（Belfield et al.，2012）辐射诱变突变体Red-1进行20倍高通量测序，发现9.19%的基因组序列发生了突变，其中包含381 403个SNP、50 116个长度1～5 bp的InDel和1279个拷贝数变异，共涉及14 493个基因。在获得群体或者个体变异信息后，我们可以通过以下命令获得变异的注释信息：

java -Xmx4g -jar snpEff.jar eff -c snpEff.config -v rice_database filter.vcf > anno.vcf

（三）基因型与表型关联分析

在获得群体基因组变异数据后，可以结合个体表型数据（如身高、体重、患病、株高、粒重等）进行连锁不平衡关系分析，获得与表型性状相关的候选基因区域，这种方法称为全基因组关联分析（GWAS）。利用GWAS技术，2005年首次进行了人类年龄相关性（Klein et al.，2005）黄斑变性的研究。后续通过这种方法在人类疾病方面发现了很多致病基因，如自闭症基因、囊性纤维化基因、亨廷顿病基因等。在植物方面，GWAS方法也定位了很多与植物重要性状（如产量、株高等）相关的候选基因，在很大程度上加速了育种的进程。在分析方面很多软件可以实现表型与基因型联合分析，如人类基因组方面常用的plink（Purcell et al.，2007）（http://pngu.mgh.harvard.edu/～purcell/plink/），植物中常用的Tassel（http://sourceforge. net/projects/tassel/）和EMMAX（Zhou and Stephens，2012）（http://genetics.cs.ucla.edu/emmax/）等软件。

（1）格式转换

在分析中，首先要进行文件格式的转化，大部分的变异检测结果都以VCF文件格式存在，首先通过VCFtools（Danecek et al.，2011）将VCF文件转换为ped格式或者TPED格式，具体命令如下。

vcftools --vcf all_last.vcf –plink #转换为plink PED格式

vcftools --vcf all_last.vcf --tped-plink #转换为plink TPED格式

（2）SNP过滤

对于转换后的文件一般进行SNP过滤，基本过滤条件为：MAF（最小等位频率）>0.05，Gene>0.05（对于单个位点检测到的样本数目大于95%），mind>0.05（个体基因型数据缺失不超过5%）。

plink --file out --noweb --maf 0.01 --geno 0.05 --mind 0.05 --out gwas #过滤后以ped格式输出

（3）关联分析

再与表型数据联合分析得到每个SNP位点与基因型的关联程度，操作命令如下：

plink --file gwas --1 --pheno pheno.txt --all-pheno --assoc –adjust

结果文件通过p值（显著值）表示该位点与该表型的相关程度，一般我们通过绘制Manhattan plot（曼哈顿图）来展示结果（图4.13）；图中横坐标为12条染色体，纵坐标为-log10（p）。

（四）QTL定位

在目标性状定位中，2012年发表的MutMap（Abe et al.，2012）方法，以野生型亲本为参考，通过全基因组比对，计算SNP频率，筛选SNP-index=1的位点，找到与表型变化相关的SNP区域。通过野生型亲本和子代DNA池SNP频率差异定位分析，找到叶片浅绿突变、茎长、叶长、花序数目、花序长度等相关的突变位点。2013年发表了一篇通过混池分组分析法（bulk segregant analysis，BSA）定位极端性状（Takagi et al.，2013）的方法，将20～50株通过EMS诱变产生的极端性状子代个体分别混合成2个DNA池，对其及亲本分别建库，利用Illumina平台进行基因组重测序，通过检测全基因组的变异，分析频率差异，成功定位了SNP-index差异群体重要农业性状的QTL。目前这种方法在植物RILs群体和Fx群体中得到了广泛使用。该软件作者也发表了相关软件和操作流程，可参考QTL-seq_framework1.4.4和MutMap_framework1.4.4（http://genome-e.ibrc.or.jp/ home/bioinformatics-team/mutmap/）。QTL-seq的结果如图4.14所示。

![图4.13 GWAS结果曼哈顿图展示](http://static.online.sciencereading.cn/readerpublic/afc7ae5a-9dfb-4133-3e5a-169e2f0e8cb2_d3b8ac6f6843e1d930ad6316733afcae/OPS/Images/Picture84_normal.png)

染色体

图4.13 GWAS结果曼哈顿图展示

![图4.14 QTL-Seq结果展示（另见彩图）](http://static.online.sciencereading.cn/readerpublic/afc7ae5a-9dfb-4133-3e5a-169e2f0e8cb2_d3b8ac6f6843e1d930ad6316733afcae/OPS/Images/Picture85_normal.png)

图4.14 QTL-Seq结果展示（另见彩图）

图4.14为QTL-seq的展示结果，图中点表示高池与低池的SNP频率差异，频率差异大的地方可能为极端表型的控制区域，通过滑动窗口的方法平均获取一定区域的差异值，通过红线表示出来，可以看到红线在7号染色体中部表现出极端情况，所以预测该区域与表型相关。

高通量测序同样也适用于传统的QTL定位。2013年，Huang等通过BinMap（Huang et al.，2009）方法构建了高密度遗传图谱进行QTL定位：通过对150个水稻RIL群体进行全基因组重测序，得到150万个SNP，利用滑动窗口来确定染色体各个区段的归属，通过群体的交换位点，构建出高密度遗传图谱进行QTL定位（图4.15）。这种方法大大提高了定位的精度和准确度，大大缩短了育种周期。此外，BinMap方法也成功应用于710份玉米F2群体（Chen et al.，2014b）GBS测序研究中，利用检测到的1155158个SNP，构建了一个含有6533个bin-maker的遗传图谱，遗传图距长度为1396 cM。通过对2个已知基因的准确定位，验证了该图谱的高质量和高准确性。对控制群体雄穗分枝数、穗行数及雌穗长度的区域进行定位，得到10个QTL，其中7个与前人报道的QTL相重叠，有3个MADS- box蛋白和一个BTB/POZ蛋白编码基因位于qTBN5和qTBN7（分别长800 kb与1.6 Mb）之中，可能参与了雄穗结构的形成。

（高 强）

![图4.15 BinMap结果展示（另见彩图）](http://static.online.sciencereading.cn/readerpublic/afc7ae5a-9dfb-4133-3e5a-169e2f0e8cb2_d3b8ac6f6843e1d930ad6316733afcae/OPS/Images/Picture86_normal.png)

图4.15 BinMap结果展示（另见彩图）

第三节 转录组测序标准信息分析

转录组测序（RNA-seq）分析根据其是否依赖参考基因组信息，主要分为两大部分：转录组从头测序（de novosequencing）测序及重测序（re-sequencing）。转录组从头测序是在不依赖物种基因组序列信息的前提下，用新一代高通量测序技术对某物种的特定组织或者细胞的转录本进行测序并获取相应的转录本信息的过程。转录组重测序针对的是具有参考基因组序列的物种，用新一代高通量测序技术对某物种的特定组织或者细胞进行转录组测序，并与参考基因组进行比较，从中得到基因表达差异、可变剪接、融合基因等转录调控信息的过程。

一、转录组数据分析

（一）数据质控

在进行转录组的从头测序和重测序时，首先要做的是数据质控处理，即对原始数据进行去除接头污染序列及低质量序列（reads）的处理。转录组测序数据与DNA测序数据的质控相似，在数据从Illumina测序仪下机之后，利用Illumina提供的软件包bcl2fastq Conversion Software进行图像数字信息转换，产出Fastq格式数据。再通过Trimmomatic、CutAdapter及Fastx（http://hannonlab.cshl.edu/fastx_ toolkit/）软件包去除接头污染序列，并对其低质量碱基进行扫描过滤，从而得到有效数据（clean data）。这一部分序列处理与DNA测序数据处理过程是相同的，具体处理过程请详见本章第一节“下机数据的初步处理”。

（二）转录组序列组装及比对

经过质控之后，RNA-seq数据分析的第一步就是要把那些测序得到的短序列（reads）比对到该物种参考基因组或者转录组序列上。这取决于被测序物种是否具有高质量的参考基因组序列。如果没有参考基因组，则需要将所得测序序列组装成转录本序列后，再与之进行比对。

转录组测序可用于未知基因组物种。通过软件组装可以获得相应的转录本序列信息，用于研究基因结构、基因功能、可变剪接和新基因预测等。值得注意的是，转录组测序数据针对的是基因组中特定的基因区域，因此对于等量的测序数据来说，转录组测序数据的基因组覆盖率要远高于DNA测序数据。目前对于测序数据量，许多测序服务商都给出了各自的推荐标准。一般来说，更多的测序数据可以更好地保证拼接组装的完整性。

RNA-seq数据的组装类似于基因组数据的组装。短读长的基因组装配工具，如Velvet（Zerbino，2010）、ABySS（Simpson et al.，2009a）和ALLPATHS（Butler et al.，2008），不能直接应用于转录组组装。原因如下：①在基因组测序中，DNA测序深度的预计值是基本一致的，而转录本的测序深度却常常相差几个数量级；②由于可变剪接是比基因组组装中的线性问题更复杂的一个转录组组装问题，通常需要作图来表示每个位点的多个可变转录本。这些特点使得转录组装配比基因组组装的计算问题更加复杂多变。

用于组装转录本序列的软件有很多，包括SOAPdenovo-Trans（Xie et al.，2014b）、Trinity（Haas et al.，2013）、Trans-ABySS（Robertson et al.，2010）等。这些软件各具特点，逐一简介如下。

1. SOAPdenovo-Trans

SOAPdenovo-Trans由华大基因开发，用于组装转录组数据，最新的版本下载地址为：http://sourceforge.net/projects/soapdenovotrans/files/SOAPdenovo-Trans/，版本为1.03，下载包中包括两个k-mer版本的程序，即“SOAPdenovo-Trans-31mer”和“SOAPdenovo-Trans-127mer”。k-mer是序列组装软件中一个非常重要的参数，定义两个reads之间重叠的长度，用于衡量两个reads是否是连续的序列。k-mer值越大，就表示高表达的转录本能够更完整地组装出来（Surget-Groba and Montoya-Burgos，2010），与此相反，低表达的基因有可能在较小的k-mer值条件下组装得更加准确。因此，k-mer值的选取取决于转录组拼接的具体需求：如果要得到更多样化的转录本，应该适当降低k-mer值；如果要得到更长的转录本，就需要提高k-mer值进行组装。一般来说，选取一个中间的k-mer值可以用来平衡两个极端的组装效果。

使用SOAPdenovo-Trans软件进行组装的命令通常如下。

$SOAP_HOME/SOAPdenovo-Trans-127mer all -s $config_file -o prefix_name -K 51 -p 40 -d 2 -e 5 -M 1 -L 200 -t 5 -G 5

表明使用SOAPdenovo-Trans-127mer在k-mer长度为51的条件下，使用40个CPU进行组装，“-d”命令通过k-mer的频率去除错误reads，而“-e”、“-M”命令均为构建de Bruijin图中的参数。“-L”、“-t”及“-G”命令用于组装后的contig和scaffold的长度、数目及gap长度的过滤。Config_file中主要包含了组装参数及数据路径等信息，如图4.16所示。

![图4.16 SOAPdenovo-Trans的参数配置文件](http://static.online.sciencereading.cn/readerpublic/afc7ae5a-9dfb-4133-3e5a-169e2f0e8cb2_d3b8ac6f6843e1d930ad6316733afcae/OPS/Images/Picture87_normal.png)

图4.16 SOAPdenovo-Trans的参数配置文件

SOAPdenovo-Trans软件的优点是速度快，内存消耗较小。

2. Trinity

Trinity是专门为转录组的组装设计的一种工具（Haas et al.，2013）。它首先将单个RNA-seq读长扩展至更长的contig，然后用这些contig构建许多de Bruijn图，然后在每幅图中得到所有的剪接异构体代表路径。命令非常简单，即：

$TRINITY_HOME/Trinity.pl --seqType fq --single single.fq --JM 20G

$TRINITY_HOME/Trinity.pl --seqType fq --left left.fq --right right.fq --JM 20G

对于链特异性的RNA-seq数据来讲，需要加上额外的参数“--SS_lib_type”用来区分不同的建库方法，如图4.17所示。

![图4.17 Trinity对于不同建库方法的参数选择](http://static.online.sciencereading.cn/readerpublic/afc7ae5a-9dfb-4133-3e5a-169e2f0e8cb2_d3b8ac6f6843e1d930ad6316733afcae/OPS/Images/Picture88_normal.png)

图4.17 Trinity对于不同建库方法的参数选择

组装后得到的转录本序列可以通过Trinity自带软件TrinityStats.pl进行信息统计，命令如下。

$TRINITY_HOME/util/TrinityStats.pl trinity_out_dir/Trinity.fasta

运行后可以得到转录本及基因的数目、N50、contig的平均长度等信息。N50是评价基因组组装质量的一个常见指标，即组装序列按长度从大到小进行排序后，取覆盖总长度50%时的contig长度。这个值越大，表明组装的序列整体长度越长，组装的效果越好。而在转录组组装过程中，Ｎ50不太适用。评价转录组组装质量时，可以确定一套已知参考基因序列集合（同一物种或相近物种），将组装序列与其进行比较，估计组装序列在参考基因集合中的覆盖率，以及覆盖全长参考基因集合的数目。这样得到的统计数值更有意义。

Surget-Groba和Montoya-Burgos（2010）提出了scaffolding using translation mapping（STM）的组装方法，通过翻译contig序列并与参考蛋白质序列进行比对，将比对到相同参考蛋白质序列的contig进行汇总并进一步组装，提高组装的正确性，从而提高组装质量。

对于组装完成的序列，可以进一步通过长度、氨基酸读码框进行筛选。筛选得到的具有较长可读框（ORF）的序列称为Unigene集合，可以用于进一步的分析。

（三）基因表达分析及差异表达基因的筛选

转录组分析中最基础和最常规的工作是基因差异表达分析。分析时，首先要确定基因的表达量，再进行样品间或基因间的表达量差异分析。

获取基因的表达量，首先要将基因比对到参考基因组序列上。如果被测序物种已经具有较高质量的参考基因组序列，就可以将reads比对到参考基因组序列上。与DNA测序数据不同，转录组测序数据比对到参考基因组上时，需要考虑参考基因组中内含子（intron）区域对比对过程的影响。因为转录组中不含有内含子，所以比对软件需要能够处理大片段的缺失（gap），用以跨过参考基因组中的内含子区域。目前常用的转录组比对软件有Tophat（Trapnell et al.，2009）、Star（Dobin et al.，2013）、Hisat（Kim et al.，2015）等。对于未知基因组的物种来说，可以把组装后的转录本序列作为参考序列来进行比对，比对软件除了同样采用Hisat等软件之外，由于组装的转录本序列不含有内含子，因此，也可以采用DNA序列比对软件，如BWA（Li and Durbin，2009a）等。

Hisat在运行时要构建大量的片段索引，不仅可以减少内存消耗，而且其比对速度要远快于Tophat，因此作者推荐采用Hisat进行序列比对。

Hisat对参考基因组建立索引的命令为：

$HISAT_HOME/hisat-build reference_genome db_name

利用Hisat进行比对的命令为：

$HISAT_HOME/hisat –p 4 –x db_name -1 left.fq -2 right.fq –S output.sam

如果构建的是单端reads的库，则比对命令为：

$HISAT_HOME/hisat –p 4 –x db_name –U single.fq –S output.sam

输出的比对格式为SAM格式，转换为BAM格式命令为：

$SAMTOOLS_HOME/samtools view [email protected] 8 –bS output.sam > output.bam

得到BAM文件格式的比对结果后，就可以进行转录本的表达量分析。评价基因的表达量时，一种是计算转录本的FPKM（fragments per kilobase of transcript per million fragments）值；另一种是计算转录本比对上的reads的数目，通常情况下选取比对到最好的且唯一位置的reads。两种方式的代表软件分别有Cufflinks（Trapnell et al.，2012）、stringTie（Pertea et al.，2015）和Htseq（Anders et al.，2015）。相对于Cufflinks，stringTie的组装速度更快，内存消耗也更小。

stringTie的命令如下：

$STRINGTIE_HOME/stringtie bamfile –G guide_gff -e –o out_gtf

Htseq的命令如下：

$HTSEQ_HOME/htseq-count -s no -i ID -t gene -q samfile gffFile > output.txt

最后根据泊松分布或负二项分布模型，判断基因表达是否在统计学水平上有差异，根据设定的差异基因筛选标准，筛选出满足条件的差异基因列表。这一过程可以利用Cuffdiff（Trapnell et al.，2012）、Ballgown（Frazee et al.，2015）、DEseq（Anders and Huber，2010）等软件进行差异表达基因的统计。

以Cuffdiff为例，命令如下：

$CUFFLINKS_HOME/cuffdiff –p 1 –u merged.gtf –b genome.fa –L S1，S2 –o S1_S2.diff S1.bam S2.bam

转录组统计筛选差异基因时，通常采取差异比值大于2倍，校正后显著性P值小于等于0.001。

（四）可变剪切分析

RNA-seq测序不仅可以分析已知转录本的表达量，还可以用于发现新的转录本，检测不同的可变剪切模式。进行Hisat、Star等序列比对软件得到的BAM文件，可以通过Cufflink、stringTie等软件进行局部reads组装，发现新的转录本信息。在这一过程中，如果已经具有已知的基因注释集合，那么可以加到数据分析中去，用来优化基因的结构。

在转录组组装时，常常会涉及多种样品的组装，如在不同时间点、不同组织中取样的样品，或者用不同条件处理的样品等，所以需要对初步的组装结果进行合并。我们可以选择Cufflink软件包中的cuffmerge进行合并操作。

cuffmerge的命令如下：

$CUFFLINKS_HOME/cuffmerge –g Guide.gtf –s genome.fa –o merge.gtf assembl_gtf_list.txt

关于转录本的描述文件GTF通常包含上万条记录，我们需要应用软件工具对它进行解析。Asprofile（Florea et al.，2013）可以对不同时间点、不同组织或不同处理条件的样品的RNA-seq数据进行可变剪切事件的提取和比较，并做转录本的定量分析。对于组装的转录本可以通过IGV（Robinson et al.，2011）等基因组浏览器进行图形化展示。

（五）SNP分析

转录组数据可以用来开发分子标记。SNP（single nucleotide ploymorphism）即单核苷酸多态性，由于其覆盖率极高足以用于区分两个生物样本和定位相应的基因，是非常热门的一类标记，经常被用来描述基因组上DNA的变异。在转录组测序中，由于测序区域大多位于基因区域，转录组的SNP分析更多的是用来区分测序样品在功能基因区域的差异，这些位于基因区域的差异更有可能与人们感兴趣的一些表型性状相关。

利用GATK（McKenna et al.，2010b）进行转录组的SNP分析流程如下。

通过Hisat与参考基因组进行比对：

$HISAT_HOME/hisat –p 4 –x db_name -1 left.fq -2 right.fq –S output.sam

添加reads测序相关信息，排序，去除重复reads：

java -jar AddOrReplaceReadGroups I=star_output.sam O=rg_added_sorted.bam SO= coordinate RGID=id RGLB=library RGPL=platform RGPU=machine RGSM= sample

java -jar MarkDuplicates I=rg_added_sorted.bam O=dedupped.bam CREATE_ INDEX=true VALIDATION_STRINGENCY=SILENT M=output.metrics

截除intron区域reads片段如图4.18，可以看出经过截除后，reads比对结果准确性得到提高：

java-jar GenomeAnalysisTK.jar -T SplitNCigarReads -R ref.fasta -I dedupped. bam -o split.bam -rf ReassignOneMappingQuality -RMQF 255 -RMQT 60 -U ALLOW_N_CIGAR_READS

这一步可以提高SNP的准确率，去除假阳性SNP。

SNP的检索及过滤命令如下。

java -jar GenomeAnalysisTK.jar -T HaplotypeCaller -R ref.fasta -I input.bam -dontUseSoftClippedBases -stand_call_conf 20.0 -stand_emit_conf 20.0 -o output.vcf

java -jar GenomeAnalysisTK.jar -T VariantFiltration -R ref.fasta -V input.vcf -window 35 -cluster 3 -filterName FS -filter "FS > 30.0" -filterName QD -filter "QD < 2.0" -o output.vcf

![图4.18 GATK截除intron区域reads的前后比对结果](http://static.online.sciencereading.cn/readerpublic/afc7ae5a-9dfb-4133-3e5a-169e2f0e8cb2_d3b8ac6f6843e1d930ad6316733afcae/OPS/Images/Picture89_normal.png)

图4.18 GATK截除intron区域reads的前后比对结果

二、转录组数据的功能注释

（一）InterPro简介

为了能够进一步了解组装后的转录本序列及其可能行使的功能，我们需要对这些组装序列进行功能注释。进行功能注释的方法有很多种，基本上都是利用了“序列相近、功能相近”的原则，即利用序列比对软件进行同源比对。

进行功能注释的方法有很多，可以直接利用现有的一些功能注释较好的数据库，如用Uniprot人工校正过的Swissprot数据库或者模式生物已注释的数据库，直接进行blast比对，设定阈值，从而得到相近的功能信息。另外，也可以使用软件及数据库进行功能注释，如PFAM、SAMRT、SUPERFAMILY、InterPro（Mitchell et al.，2015）等。

InterPro（http://www.ebi.ac.uk/interpro/）是一个综合性数据库，主要用于蛋白质及基因组的分类与自动注释。InterPro将序列按照超家族、家族、子家族等不同水平，将蛋白质序列进行分类，预测序列的功能保守域、重复序列、关键位点等。其相应的软件为InterProScan（Jones et al.，2014）。下载InterProScan后需要下载相应的各种数据库及相应软件进行配置。InterProScan不仅可以进行序列的功能注释，还可以进行GO、Pathway等相应的高级功能分析，因此它是一个综合功能比较强大的、可用于批量化注释的软件包。

（二）COG分析

Orthologs是指来自于不同物种的由垂直家系（物种形成）进化而来的蛋白质，并且典型地保留着与原始蛋白质相同的功能。Paralogs是那些在一定物种中来源于基因复制的蛋白质，可能会进化出与原来功能有关的新功能。“COG”是cluster of orthologous groups of proteins（直系同源蛋白相邻类的聚簇）的缩写（Tatusov et al.，1997）。由于Orthologs一般保留相同的功能，因此，利用NCBI的COG数据库，基于同源序列比对的信息，可以推断未知序列的功能，以及是否参与特定的代谢途径。COG用不同的大写字母进行功能及代谢途径的分类。图4.19是基于COG分析后得到的功能分类图。

![图4.19 COG功能分类样图](http://static.online.sciencereading.cn/readerpublic/afc7ae5a-9dfb-4133-3e5a-169e2f0e8cb2_d3b8ac6f6843e1d930ad6316733afcae/OPS/Images/Picture90_normal.png)

图4.19 COG功能分类样图

（三）GO注释

“GO”是gene ontology（基因本体论）的缩写。它给出了3种不同的定义，包括分子功能（molecular function）、生物学途径（biological process）、细胞组分（cellular component）。这3种不同特征的定义可以对基因产物进行全方位的描述。对于一些已知物种，如果GO官网（http://geneontology.org/）已经完成了该物种的蛋白质分类，可以直接检索使用。如果从该网站检索不到目的蛋白，可以通过序列比对，找到含有功能注释的同源蛋白。通过Blast2GO（Conesa et al.，2005）或者InterProScan软件可以实现这一过程。Blast2GO是一个图形化界面的软件，通过分步操作，可以实现从序列比对到最终功能注释等许多分析，同时，还可以对注释结果进行分类汇总。由于Blast2GO简便易学，因此推荐读者使用Blast2GO软件进行功能分析。图4.20为该软件序列比对的界面图（https://www.blast2go. com/blast2go-pro），可以选择不同数据库进行比对。

![图4.20 Blast2GO软件界面](http://static.online.sciencereading.cn/readerpublic/afc7ae5a-9dfb-4133-3e5a-169e2f0e8cb2_d3b8ac6f6843e1d930ad6316733afcae/OPS/Images/Picture91_normal.png)

图4.20 Blast2GO软件界面

（四）Pathway注释

目前与Pathway相关的数据库有KEGG、MetaCyc、Reactome、UniPathway等。与GO注释相似，Pathway的注释也需要通过序列比对进行预测。能够完成这一过程的软件有KOBAS2.0（Xie et al.，2011）、InterProScan，Blast2GO也有相应的模块进行Pathway的分析。

KOBAS2.0既有在线的服务器，也可以下载后构建本地数据库进行分析。KOBAS2.0是使用Python编写的软件，分为两部分。第一部分是annotate过程，即将序列与KEGG等数据库中的蛋白质序列进行比对，从而得到对应关系，这一过程可以帮助我们得到Unigene集合相对应的Pathway的信息。第二部分是identify过程，即功能富集分析，在本节“二、（五）”中介绍。

KOBAS2.0命令行如下。

python annotate.py -i query.tab -s db -t blastout:tab -o annotate.out -e 1e-20 -n 1

KEGG有相应的API程序（http://www.kegg.jp/kegg/rest/keggapi.html），可以对KOBAS2.0的结果进行丰富注解，如图4.21所示，通过其API的接口可以清楚地显示出不同类型的蛋白质信息。

![图4.21 KEGG中氧化磷酸化途径展示图](http://static.online.sciencereading.cn/readerpublic/afc7ae5a-9dfb-4133-3e5a-169e2f0e8cb2_d3b8ac6f6843e1d930ad6316733afcae/OPS/Images/Picture92_normal.png)

图4.21 KEGG中氧化磷酸化途径展示图

（五）功能富集分析

GO注释及Pathway注释均可以进行功能富集分析。功能富集分析采用的是一种概率算法，称为超几何分布（hypergeometric distribution）。通过Fisher精确检验（Fisher exact test），用于描述两个集合中是否符合同一分布的概率。在转录组数据分析中，参考数据的集合，即背景数据，通常以所有的表达基因作为背景。而某些特定的基因，则被认为是前景数据，通常组织或者处理间所鉴定的差异基因作为前景。通过计算前景数据与背景数据在某个GO或者Pathway分类中的超几何分布关系，可以返回该前景数据在这个分类上的显著差异值，即P值，再经过多重校正（multiple testing），可以得到校正后的P值。一般功能富集的筛选标准为校正后P值小于0.05。校正后的P值越小，前景数据与背景数据的差异就越显著，表明所关注的前景基因可能与该功能分类密切相关。Blast2GO及KOBAS2.0均可以进行功能富集分析。这个过程也是很简单的。在KOBAS2.0中命令行具体如下。

python identify.py -f foreground.out -b background.out -o annotate.identify

三、小RNA数据分析

小RNA（miRNA）来源于一段有折叠的发卡结构的单链RNA序列，主要参与调节内源基因的转录和翻译（Carthew and Sontheimer，2009）。

（一）数据预处理

因为小RNA序列长度是18～30 nt，小于高通量测序得到的reads长度，所以reads会有一段3′接头序列。因此在处理小RNA序列时，除了常规的去污染、去低质量序列，还需要去掉接头序列。这一过程与DNA质控软件相同，可以采用Trimmomatic等工具进行处理。

（二）序列比对

miRNA测序数据有两个特征，一是序列读长短，二是相同的序列重复率高。因此在做序列比对时，可以先把序列去冗余，统计出每条序列在一个样品中有多少次重复，再比对到参考基因组。比对时要保证完全匹配，并且如果reads可以比对到多个位置，则要保留每个位置的比对记录。能够完全比对到参考基因组的序列进行下一步的分析。采用的比对软件为BWA等。

（三）序列分类

将比对到基因组上的reads与已知类型序列比对，可以对这些reads进行分类。与已有的基因组注释比对，可以区分编码和非编码RNA；与miRBase（Griffiths-Jones et al.，2006）数据库比对，可以得到已知miRNA；与Rfam（Nawrocki et al.，2015）数据库及GenBank数据库比对，可得到rRNA、tRNA、snRNA等降解片段；与Repbase（Bao et al.，2015）数据库比对，可以找出重复序列和转座子相关序列。在剩下的序列中筛选出18～30 nt的序列进行进一步的miRNA预测。

（四）新miRNA预测

通过序列分类，筛选出可能的新miRNA序列。miRNA前体的标志性发夹结构能够用来预测新的miRNA。根据序列比对结果，截取附近区域的一段序列，作为miRNA的前体序列，利用miRNA预测软件，可从计算角度判断该序列是否是miRNA，进一步的判断还需要实验验证。相应的软件有miRPlant（An et al.，2014）、mirtools（Wu et al.，2013）等。

miRPlant是一个界面友好，且不依赖第三方软件的预测植物miRNA的软件（图4.22）。从拿到原始测序reads到预测出miRNA，都可通过miRPlant独立完成。miRPlant软件包含以下几个步骤。

![图4.22 miRPlant软件界面（引自miRPlant: an integrated tool for identification of plant miRNA from RNA sequencing data. BMC Bioinformatics. 2014, 15:275）](http://static.online.sciencereading.cn/readerpublic/afc7ae5a-9dfb-4133-3e5a-169e2f0e8cb2_d3b8ac6f6843e1d930ad6316733afcae/OPS/Images/Picture93_normal.png)

图4.22 miRPlant软件界面（引自miRPlant: an integrated tool for identification of plant miRNA from RNA sequencing data. BMC Bioinformatics. 2014, 15:275）

1）过滤掉长度在10～23 bp之外的reads，或质量值低于设定阈值的reads。

2）序列一样的reads合并为一条reads。

3）以完全匹配的方式把reads比对到参考基因组。

4）通过RNA二级结构算法确定RNA-seq reads在参考基因组的临近区域能否形成发卡结构。

5）通过miRDeep model给预测的miRNA打分，分数越高，预测的miRNA的准确性越高。

软件需要输入adapter序列和测序reads或者bam文件，其他参数可以根据情况自行调整。adapter序列：由于miRNA本身序列比测序reads短，在测序过程中会测到接头序列，miRPlant提供了去接头序列的功能。adapter序列可根据实际情况选择对应的接头序列。软件可以接受fq、fa和bam文件，如果提供的是fq和fa，会首先进行序列比对，再执行miRNA识别程序，如果是bam文件，会直接执行miRNA识别程序。

（五）miRNA的靶基因预测

通过已有的数据库，可以获得已知miRNA的靶基因，新的miRNA需要通过靶基因预测软件进行预测。通过miRNA和靶基因的对应关系，我们可以对基因的调控关系进行研究。这一过程中的预测软件有psRobot（Wu et al.，2012）、miRBase、miRNAMap（Hsu et al.，2008）和TargetScanS（Lewis et al.，2005）等。

psRobot提供在线和本地两种版本（参考http://omicslab.genetics.ac.cn/psRobot/ help_stem_loop.php），功能如下。

1）把小RNA比对到参考基因组，确定其在基因组上的位置。

2）分析小RNA是否为重复序列及重复序列的类型。

3）小RNA在小RNA合成相关蛋白复合物中的表达情况。

4）小RNA前体序列的二级结构。

5）预测小RNA的目标基因。

6）小RNA和目标基因在拟南芥、水稻、高粱、玉米等植物中的保守性。

7）降解组数据中目标基因的剪切信息。

预测小RNA的目标基因：需要提供的数据包括小RNA的序列和mRNA的序列，这两类数据都可以用已有的序列，或选择自己提供序列。然后设定预测目标基因的相关参数，即可进行小RNA的目标基因预测。

（六）表达模式分析

通过统计样品中miRNA的数目，可以获得count-base类型的表达量。可以对样品进行聚类分析、差异表达分析、通路及功能的富集分析，具体分析参考转录组分析流程。

（曹英豪 李 妍）

第四节 建造中等高性能计算机群系统

一、高性能计算技术简介

高性能计算（HPC）是一个计算机集群系统，它通过各种互联技术将多个计算机系统连接在一起，利用被连接的系统的综合计算能力来处理大型数据与计算问题，通常又被称为高性能计算集群。

高性能计算方法的基本原理就是将问题分为若干部分，集群中的每台计算机（称为节点）均可同时参与问题的解决，从而显著缩短了计算时间。

解决大型计算问题需要功能强大的计算机系统。随着高性能计算系统的出现，这一类应用从昂贵的大型外部计算机系统演变为采用商用服务器产品和软件的高性能计算机集群。因此，高性能计算系统已经成为解决大型问题的计算机系统的发展方向。那么，什么样的大型问题最适合使用高性能计算系统呢？

一般来说，高性能计算系统是为了满足以下需要的计算系统：①能够突破性能极限的计算；②单个高端计算机系统不能满足其需求的计算；③需要通过专门的程序优化最大限度提高系统的I/O、计算和数据传送性能的计算。

二、如何有效地构建高性能计算集群

一套成熟的、高效的高性能计算集群，应由以下几部分构成：节点、存储系统、作业调度系统、高效计算网络、加速卡等。下面我们对这五项分别进行阐述。

（一）节点

高性能计算是由多个节点组成的，每个节点是一个独立的管理或计算单元，能够独立参与任务的计算，节点数量及节点性能是反映一个高性能计算集群计算能力的基本指标。

（二）存储系统

高性能计算中的存储系统有其独特性。由于高性能计算集群具有节点众多、需要各节点协同完成同一任务等特性，因此要求接入高性能计算的存储系统应具有高并发、高I/O、高处理效率、统一命名空间等特性。

（三）作业调度系统

由众多计算、管理、存储等节点共同参与的高性能计算集群系统，必须有一套高效快捷的系统把这些资源管理起来，它就是作业调度系统，这套系统是高性能计算集群的重中之重。

作业调度系统的主要功能是根据作业控制块中的信息，审查系统能否满足用户作业的资源需求，以及按照一定的算法，从外存的后备队列中选取某些作业调入内存，并为它们创建进程、分配必要的资源。然后再将新创建的进程插入就绪队列，准备执行。因此，有时也把作业调度称为接纳调度。

（四）高效计算网络

高性能计算集群中一大类任务是mpi类计算任务，该任务需要多个节点共同协作来完成。一个复杂的作业由作业调度系统拆解成若干个计算单元，再将这些计算单元分配到不同节点的不同计算核心中进行并行计算。由于并行计算是具有结果依赖性的，因此在每一步或每几步计算之后，所有节点的计算核心要进行数据交互。这就需要我们的计算网络具有高带宽、低延迟特性。

假设我们的并行颗粒度相对较大，尽管单位任务被拆解得非常小，但由于一次计算可能要经历数百万次的数据交互，每次数据交互如果有0.1 s的延迟，那么数百万次的数据交互所产生的等待时间是让人无法忍受的，甚至会超过任务拆解前所需要的计算时间。

所以高效的计算网络，是保证并行计算有效运行的基本前提。

（五）加速卡

高性能计算集群中的主要计算资源是CPU，但一些特殊的场景或一些特殊的算法可以通过GPU或MIC来进行加速，从而达到提高计算效率的目的。

三、建造中等测序中心所需高性能计算集群的硬件配置

随着测序技术的飞速发展，单位时间内的数据产出量呈几何倍数增长，从而推进了测序中心中高性能计算集群技术的发展。下面我们根据目前中等测序中心的数据产出及处理能力，给出一个相对的高性能计算集群的基本配置需求。

（一）系统架构

整套集群采用高性能计算系统架构。配有作业调度系统，各节点采用Linux CentOS6操作系统，两个管理节点配置High Available，4个登录节点配置Load Balance，从而达到整个集群系统高度可用且可负载均衡。

（二）计算能力

总计算能力不低于15 Tflops/s，其中应按照1︰4的计算核心比例来配置胖节点与普通计算节点。

胖节点的总内存数应不低于1 TB，CPU核心数应大于80核。

计算节点总内存数应不低于196 GB，CPU核心数应大于24核。

（三）存储需求

应采用并行存储系统，I/O节点数目不少于10个，MDS节点应配置HA。裸容量不低于1PB，总带宽不小于4 GB/S，可负载不小于3 W的IOPS。

该存储支持并行文件系统，且在集群中以统一命名空间访问。

（四）计算网络

计算网络应采用56 Gb/s的无限带宽技术（infiniband）高速计算网络，保证整套系统的高带宽及低延时。

四、高性能计算集群的工作环境要求

服务器存储设备需要放置在专用的中心机房中使用。为了保证高性能计算集群的高效运行，高性能计算集群所依赖的中心机房尤为重要。下面简单介绍高性能计算中心机房的建设标准及工作环境要求。

机房建设是建筑智能化系统的一个重要部分。机房建设涵盖了建筑装修、供电、照明、防雷、接地、UPS不间断电源、精密空调、环境监测、火灾报警及灭火、门禁、防盗、闭路监视、综合布线和系统集成等技术。

（一）高性能计算中心机房建设思想

整体机房建设：将机房设备、监控设备、强弱电系统、数据/非数据设备等作为一个完整的系统考虑，尽量发挥各子系统的联动、互动作用。

可管理、可扩展：现代机房建设已不仅仅是功能上的要求，而且要具有良好的可管理性，为用户提供友善的管理界面，同时要保证容量、性能的可扩展性，以保护用户投资。

高质量项目管理：机房建设是一项专业化的综合性工程。要求对装修、配电、空调、新排风、监控、门禁、消防、防雷、防过压、接地、综合布线和网络等各个子系统的建设规划、方案设计、施工安装等过程进行严密的统筹管理，以保证工程的质量和周期。

（二）机房建设标准

机房建设应遵循如下标准。

国家标准《电子计算机机房设计规范》（GB50174-93）

国家标准《计算站场地技术条件》（GB2887-89）

国家标准《电子计算机机房施工及验收规范》（SJ/T30003-93）

国家标准《计算机机房活动地板的技术要求》（GB6650-86）

国家标准《计算站场地安全技术》（GB9361-88）

国家标准《电气装置安装工程接地装置施工及验收规范》（GB50169-92）

公共安全行业标准《安全防范工程程序与要求》（GA/T75-94）

《中华人民共和国计算机信息系统安全保护条例》

《工业企业照明设计标准》（GB50034-92）

《室内装饰工程质量规范》（QB 1838-93）

（三）机房建设方案

机房建设方案的设计应根据用户提出的技术要求，对机房建设的建筑物进行实地勘查，依据国家有关标准和规范，结合所建各种系统运行特点进行总体设计。总体机房建设方案以业务完善技术规范，安全可靠为主，确保系统安全可靠地运行。在选材投资方面根据功能及设备要求区别对待，并满足用户的特殊要求，做到投资有重点，保证机房场地工作人员的身心健康，延长系统的使用寿命。机房建设的工作就是围绕这个根本任务，通过采用优质产品和先进工艺把上述设计思想有机地结合起来，为机房里的设备和工作人员创造一个安全、可靠、美观、舒适的工作场地。

一个全面的机房建设应包括以下几个方面：①机房装修；②供电系统；③空调系统；④门禁系统；⑤监控系统；⑥消防报警系统；⑦防雷接地系统。

1.机房装修

机房建设中的机房装修主要包括吊顶，隔断墙，门、窗、墙壁装修，地面、活动地板的施工验收及其他室内作业。机房装修是整个机房建设的基础，是机房环境建设的重要环节。机房必须具备防尘、防潮、抗静电、阻燃、绝缘、隔热、降噪声的物理环境，机房功能区域分隔要清晰明了、便于识别和维护。

机房装修作业应符合《装饰工程施工及验收规范》、《地面与楼面工程施工及验收规范》、《木结构工程施工及验收规范》及《钢结构工程施工质量验收规范》的有关规定。

在机房建设过程中应保证现场、材料和设备的清洁。隐蔽工程（如地板下、吊顶上、假墙、夹层内）在封口前必须先除尘、清洁处理，暗处表层应能保持长期不起尘、不起皮和不龟裂。

机房所有管线穿墙处的裁口必须做防尘处理，必须对缝隙采用密封材料填堵。在裱糊、粘接贴面及进行其他涂复施工时，其环境条件应符合材料说明书的规定。

机房装修材料应尽量选择无毒、无刺激性、难燃、阻燃的材料，否则应尽可能涂防火涂料。

2.供电系统

1）保证机房核心设备（服务器、网络设备及辅助设备）安全稳定运行。核心设备供电系统必须达到一类供电标准，即必须建立不间断供电系统。市电停电时，不间断电源系统主机电源实际输出功率宜大于后端负载1.5倍，满负荷运转时间不得少于120 min。

2）信息系统设备供电系统必须与动力、照明系统分开。供电系统要求：频率，50 Hz；电压，380 V/220 V；相数，三相五线或三相四线制/单相三线制；稳态电压偏移范围220 V（–10%～+10%）；稳态频率偏移范围，50Hz（–0.5%～+0.5%）。

3）电力布线要求：机房UPS电源要采用独立双回路供电，输入电流应符合UPS输入端电流要求；静电地板下的供电线路置于管内，分支到各用电区域，向各个用电插座分配电力，防止外界电磁干扰系统设备；线路上要有标签说明去向及功能。

3.空调系统

1）通过机房空调系统保持机房内相对稳定的温度和湿度，使机房内的各类设备保持良好的运行环境，确保系统可靠、稳定运行。机房系统要求：全年温度，18～25℃；相对湿度，35%～65%；温度变化率，<10℃/h；并不得结露。

2）机房要有防水害措施，确保机房安全运行（机房一般都配备恒温湿装置，所以在一般情况下禁止使用冷、暖气系统，如已使用则必须对系统给排水管道采取严格的防漏及补救措施）。

3）根据《计算站场地技术条件》（GB2887-89）机房技术要求，按A级设计，温度T=（23±2）℃，相对湿度=55%±5%，夏季取上限，冬季取下限。气流组织采用下送风、上回风，即抗静电活动地板静压箱送风，吊顶天花微孔板回风。新风量设计取总风量的10%，中低度过滤，新风与回风混合后，进入空调设备处理，提高控制精度，节省投资，方便管理。

4.门禁系统

机房建设中的门禁管理系统的主要目的是保证重要区域设备和资料的安全，便于人员的合理流动，对进入这些重要区域的人员实行各种方式的门禁管理，以便限制人员随意进出；卡片最好采用现在流行的感应式卡片；卡出入系统首先应具有权限设置的功能，即每张卡可进出的时间、可进出哪道门，不同的卡片持有者应有不同的权限；每次有效的进入都应存档或统计；应有完善的密码系统，即对系统的更改，不同的操作者应有不同的权限；电锁应采用安全可靠的产品，有电闭锁或无电闭锁根据用户要求可调；紧急情况下或电锁出现故障的情况下应有应急钥匙可将门打开；门禁系统最好采用计算机控制系统；全套系统最好有备用电源。

5.监控系统

机房中有大量的服务器及机柜、机架。由于这些机柜及机架一般比较高，监控的死角比较多，因此在电视监控布点时主要考虑各个出入口，每一排机柜之间安装摄像机。如果在各出入口的空间比较大，可考虑采用带变焦的摄像机，在每一排的机柜之间，根据监视距离，配定焦摄像机即可。如果机房有多个房间的话，可考虑在UPS房和控制机房内安装摄像机。

机房监控图像信号应保持24 h录像，录像方式可采用硬盘录像，也可采用传统的录像系统。闭路电视控制系统最好有视频动态报警功能。同时如果具有视频远程传输功能，即通过互联网、ISDN、局域网或电话线将监视信号传输到远程客户指定的地方，在使用时将会更加方便。

6.消防报警系统

机房内有许多重要设备，其价值较高，分布密集，且需要24 h不间断运行，对消防要求较高，一旦机房出现火灾，为保证设备安全，需要消防系统在第一时间内自动启动进行灭火，通知远程管理人员减少损失。

机房的物理环境：机房的结构、材料、配置设施必须满足保温、隔热、防火等要求。

机房应有温感、烟感、报警器等装置和消防设备设施，必须采用气体灭火剂。

7.防雷接地系统

为防止机房设备的损坏和数据的丢失，机房建设中机房的防雷接地尤其重要。按国家建筑物防雷设计规范，本机房建设方案对机房电气电子设备的外壳、金属件等实行等电位连接，并在低压配电电源电缆进线输入端加装电源防雷器。机房防雷接地系统注意以下两点。

1）机房的接地系统必须安装室外的独立接地体；直流地、防静电地采用独立接地；交流工作地、安全保护地采用电力系统接地；不得共用接地线缆，所有机柜必须接地。

2）机房防雷系统的外部防护主要由建筑物自身防雷系统来承担；由室外直接接入机房金属信息线缆，必须作防浪涌处理；所有弱电线缆不裸露于外部环境；弱电桥架使用扁铜软线带跨接，进行可靠接地；机房电源系统至少进行二极防浪涌处理；重要负载末端防浪涌处理。

机房建设除了上述系统外，还有穿插于整个机房建设的综合布线系统，机房综合布线系统应满足主干线路有冗余，机房布线系统中所有的电缆、光缆、信息模块、接插件、配线架、机柜等在其被安装的场所均要容易被识别，线缆布设整齐，布线中的每根电缆、光缆、信息模块、配线架和端点要指定统一的标志符，电缆在两端要有标注，保证维修方便、操作灵活。

五、下机数据的自动化传输

以HiSeq2500为例，测序仪所配置主机的存储空间及存储效率有限，且最终数据要放到高性能计算集群中进行分析。所以我们有必要对下机数据进行自动化传输配置，保证测序下机数据自动传输到高性能计算集群中，方便后续的数据处理。

针对类似于HiSeq系列的测序仪，控制器操作系统为Windows系统，我们可以采用CIFS或ISCSI的方式将存储系统挂载到测序仪上。将测序数据的生成目录更改为此动态存储，即可完成下机数据的自动传输。

针对类似于Ion Torrent系列的测序仪，控制器操作系统为类Linux系统，我们可以采用NFS或ISCSI的方式将存储系统挂载到测序仪上。将测序数据的生成目录更改为此动态存储，即可完成下机数据的自动传输。

在数据处理段，应将该共享卷设置为只读。下机数据的预处理不需要对原始下机数据进行任何写操作，从而保证数据的读一致性。

（杨 鑫）

参 考 文 献

Abe A, Kosugi S, Yoshida K, et al. 2012. Genome sequencing reveals agronomically important loci in rice using MutMap. Nature Biotechnology, 30(2): 174-178.

An J, Lai J, Sajjanhar A, et al. 2014. miRPlant: an integrated tool for identification of plant miRNA from RNA sequencing data. BMC Bioinformatics, 15: 275.

Anders S, Huber W. 2010. Differential expression analysis for sequence count data. Genome Biol, 11(10): R106.

Anders S, Pyl P T, Huber W. 2015. HTSeq--a Python framework to work with high-throughput sequencing data. Bioinformatics, 31(2): 166-169.

Bao W, Kojima K K, Kohany O. 2015. Repbase Update, a database of repetitive elements in eukaryotic genomes. Mob DNA, 6: 11.

Belfield E J, Gan X, Mithani A, et al. 2012. Genome-wide analysis of mutations in mutant lineages selected following fast-neutron irradiation mutagenesis ofArabidopsis thaliana. Genome Research, 22(7): 1306-1315.

Bolger A M, Lohse M, Usadel B. 2014. Trimmomatic: a flexible trimmer for Illumina sequence data. Bioinformatics: btu170.

Butler J, MacCallum I, Kleber M, et al. 2008. ALLPATHS: de novo assembly of whole-genome shotgun microreads. Genome Res, 18(5): 810-820.

Carthew R W, Sontheimer E J. 2009. Origins and Mechanisms of miRNAs and siRNAs. Cell, 136(4): 642-655.

Chen W, Gao Y, Xie W, et al. 2014a. Genome-wide association analyses provide genetic and biochemical insights into natural variation in rice metabolism. Nature Genetics, 46(7): 714-721.

Chen Z, Wang B, Dong X, et al. 2014b. An ultra-high density bin-map for rapid QTL mapping for tassel and ear architecture in a large F2 maize population. BMC Genomics, 15(1): 433.

Chikhi R, Medvedev P. 2013. Informed and automated k-mer size selection for genome assembly. Bioinformatics: btt310.

Conesa A, Gotz S, Garcia-Gomez J M, et al. 2005. Blast2GO: a universal tool for annotation, visualization and analysis in functional genomics research. Bioinformatics, 21(18): 3674-3676.

Danecek P, Auton A, Abecasis G, et al. 2011. The variant call format and VCFtools. Bioinformatics, 27(15): 2156-2158.

Dobin A, Davis C A, Schlesinger F, et al. 2013. STAR: ultrafast universal RNA-seq aligner. Bioinformatics, 29(1): 15-21.

Florea L, Song L, Salzberg S L. 2013. Thousands of exon skipping events differentiate among splicing patterns in sixteen human tissues. F1000Res, 2: 188.

Frazee A C, Pertea G, Jaffe A E, et al. 2015. Ballgown bridges the gap between transcriptome assembly and expression analysis. Nat Biotechnol, 33(3): 243-246.

Gordon A, Hannon G. 2010. Fastx-toolkit. FASTQ/A short-reads preprocessing tools. unpublished)http: //hannonlab. cshl. edu/fastx_toolkit [2015-8-12].

Griffiths-Jones S, Grocock R J, van Dongen S, et al. 2006. miRBase: microRNA sequences, targets and gene nomenclature. Nucleic Acids Res, 34(Database issue): D140-144.

Haas B J, Papanicolaou A, Yassour M, et al. 2013. De novo transcript sequence reconstruction from RNA-seq using the Trinity platform for reference generation and analysis. Nat Protoc, 8(8): 1494-1512.

Hsu S D, Chu C H, Tsou A P, et al. 2008. miRNAMap 2.0: genomic maps of microRNAs in metazoan genomes. Nucleic Acids Res, 36(Database issue): D165-169.

Huang X, Feng Q, Qian Q, et al. 2009. High-throughput genotyping by whole-genome resequencing. Genome Research, 19(6): 1068-1076.

Jia J, Zhao S, Kong X, et al. 2013. Aegilops tauschii draft genome sequence reveals a gene repertoire for wheat adaptation. Nature, 496(7443): 91-95.

Jiang Y H, Yuen R K, Jin X, et al. 2013. Detection of clinically relevant genetic variants in autism spectrum disorder by whole-genome sequencing. The American Journal of Human Genetics, 93(2): 249-263.

Jones P, Binns D, Chang H Y, et al. 2014. InterProScan 5: genome-scale protein function classification. Bioinformatics, 30(9): 1236-1240.

Kim D, Langmead B, Salzberg S L. 2015. HISAT: a fast spliced aligner with low memory requirements. Nat Methods, 12(4): 357-360.

Klein R J, Zeiss C, Chew E Y, et al. 2005. Complement factor H polymorphism in age-related macular degeneration. Science, 308(5720): 385-389.

Lewis B P, Burge C B, Bartel D P. 2005. Conserved seed pairing, often flanked by adenosines, indicates that thousands of human genes are microRNA targets. Cell, 120(1): 15-20.

Li H, Durbin R. 2009. Fast and accurate short read alignment with Burrows-Wheeler transform. Bioinformatics, 25(14): 1754-1760.

Li H, Handsaker B, Wysoker A, et al. 2009. The sequence alignment/map format and SAMtools. Bioinformatics, 25(16): 2078-2079.

Li R, Fan W, Tian G, et al. 2010. The sequence and de novo assembly of the giant panda genome. Nature, 463(7279): 311-317.

Li R, Li Y, Kristiansen K, et al. 2008. SOAP: short oligonucleotide alignment program. Bioinformatics, 24(5): 713-714.

Ling H Q, Zhao S, Liu D, et al. 2013. Draft genome of the wheat A-genome progenitorTriticum urartu. Nature, 496(7443): 87-90.

Lynam C P, Gibbons M J, Axelsen B E, et al. 2006. Jellyfish overtake fish in a heavily fished ecosystem. Current Biology, 16(13): R492-R493.

McKenna A, Hanna M, Banks E, et al. 2010. The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data. Genome research, 20(9): 1297-1303.

Mitchell A, Chang H Y, Daugherty L, et al. 2015. The InterPro protein families database: the classification resource after 15 years. Nucleic Acids Res, 43(Database issue): D213-221.

Morris G P, Ramu P, Deshpande S P, et al. 2013. Population genomic and genome-wide association studies of agroclimatic traits in sorghum. Proceedings of the National Academy of Sciences, 110(2): 453-458.

Nawrocki E P, Burge S W, Bateman A, et al. 2015. Rfam 12.0: updates to the RNA families database. Nucleic Acids Res, 43(Database issue): D130-137.

Pertea M, Pertea G M, Antonescu C M, et al. 2015. StringTie enables improved reconstruction of a transcriptome from RNA-seq reads. Nat Biotechnol, 33(3): 290-295.

Purcell S, Neale B K, Todd-Brown, et al. 2007. PLINK: a tool set for whole-genome association and population-based linkage analyses. The American Journal of Human Genetics, 81(3): 559-575.

Robertson G, Schein J, Chiu R, et al. 2010. De novo assembly and analysis of RNA-seq data. Nat Methods, 7(11): 909-912.

Robinson J T, Thorvaldsdottir H, Winckler W, et al. 2011. Integrative genomics viewer. Nat Biotechnol, 29(1): 24-26.

Simpson J T, Wong K, Jackman S D, et al. 2009. ABySS: a parallel assembler for short read sequence data. Genome Res, 19(6): 1117-1123.

Surget-Groba Y, Montoya-Burgos J I. 2010. Optimization of de novo transcriptome assembly from next-generation sequencing data. Genome Res, 20(10): 1432-1440.

Takagi H, Abe A, Yoshida K, et al. 2013. QTL-seq: rapid mapping of quantitative trait loci in rice by whole genome resequencing of DNA from two bulked populations. The Plant Journal, 74(1): 174-183.

Tatusov R L, Koonin E V, Lipman D J. 1997. A genomic perspective on protein families. Science, 278(5338): 631-637.

Trapnell C, Pachter L, Salzberg S L. 2009. TopHat: discovering splice junctions with RNA-Seq. Bioinformatics, 25(9): 1105-1111.

Trapnell C, Roberts A, Goff L, et al. 2012. Differential gene and transcript expression analysis of RNA-seq experiments with TopHat and Cufflinks. Nat Protoc, 7(3): 562-578.

Wu H J, Ma Y K, Chen T, et al. 2012. PsRobot: a web-based plant small RNA meta-analysis toolbox. Nucleic Acids Res, 40(Web Server issue): W22-28.

Wu J, Liu Q, Wang X, et al. 2013. mirTools 2.0 for non-coding RNA discovery, profiling, and functional annotation based on high-throughput sequencing. RNA Biol, 10(7): 1087-1092.

Xie C, Mao X, Huang J, et al. 2011. KOBAS 2.0: a web server for annotation and identification of enriched pathways and diseases. Nucleic Acids Res, 39(Web Server issue): W316-322.

Xie Y, Wu G, Tang J, et al. 2014. SOAPdenovo-Trans: de novo transcriptome assembly with short RNA-Seq reads. Bioinformatics, 30(12): 1660-1666.

Yoshida S, Ishida J K, Kamal N M, et al. 2010. A full-length enriched cDNA library and expressed sequence tag analysis of the parasitic weed,Striga hermonthica. BMC plant biology, 10(1): 55.

Zerbino D R. 2010. Using the Velvet de novo assembler for short-read sequencing technologies. Curr Protoc Bioinformatics Chapter, 11: Unit 11, 15.

Zhang G, Fang X, Guo X, et al. 2012. The oyster genome reveals stress adaptation and complexity of shell formation. Nature, 490(7418): 49-54.

Zhou X, Stephens M. 2012. Genome-wide efficient mixed-model analysis for association studies. Nature Genetics, 44(7): 821-824.

Zhou Z, Jiang Y, Wang Z, et al. 2015. Resequencing 302 wild and cultivated accessions identifies genes related to domestication and improvement in soybean. Nature Biotechnology, 33(4): 408-414.

Zimin A V, Marçais G, Puiu D, et al. 2013. The MaSuRCA genome assembler. Bioinformatics, 29(21): 2669-2677.
